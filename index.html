<!DOCTYPE html>

<html>
    <head>
        <title>Neural Network Testing</title>
        <script src="badnn.js"></script>
        <link rel="stylesheet" href="../main.css">
    </head>

    <body>

        <script>
            // let nn = new NeuralNet(1, 1)
            // // console.log(nn.p)
            // console.log(nn.evaluate([2]))

            let fitnessFunc = (nn)=>{ // number flipper

                let trialsum = 0

                for(var i = 0; i < 100; i ++){
                    let input = Math.random()*20 - 10
                    let output = nn.evaluate([input])[0]

                    // return -Math.abs(output-(-(input-0.5)+0.5))
                    let sin = Math.sin(input * 0.4)
                    trialsum += -(output - sin) * (output - sin)
                }

                return trialsum
            }

            let nn = new NeuralNet(1, 1, NeuralNet.prototype.createWeights(3, 2, 1, 1))
            // nn.trainEvolution(fitnessFunc, 10, 1000)
            // nn.trainGradientDescent(fitnessFunc, 1000)
        </script>

        <canvas id="main" width = "512" height="512"></canvas>

        <script>
            setInterval(()=>{

                nn.trainGradientDescent(fitnessFunc, 500)
                // nn.trainEvolution(fitnessFunc, 10, 100)

                const c = document.getElementById('main')
                const ctx = c.getContext('2d')

                ctx.fillStyle="#000000"
                ctx.fillRect(0,0,512,512)

                ctx.fillStyle="#ffffff"
                let yscale = 20

                for(var i = -10; i < 20; i += 0.15){
                    let v = nn.evaluate([i])[0]
                    // console.log(v)
                    ctx.fillRect((i + 10)*512/20, -v*yscale + 256, 4, 2)

                    ctx.fillRect((i + 10)*512/20, -Math.sin(i * 0.4)*yscale + 256, 1, 1)

                }
            }, 1000
            )
        </script>

    </body>
</html>